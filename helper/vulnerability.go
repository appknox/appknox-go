package helper

import (
	"context"
	"fmt"
	"os"

	"github.com/cheynewallace/tabby"
)

// ProcessVulnerability takes the vulnerabilityID and print it's details to CLI.
func ProcessVulnerability(vulnerabilityID int) {
	ctx := context.Background()
	client := getClient()
	vulnerability, _, err := client.Vulnerabilities.GetByID(ctx, vulnerabilityID)
	if err != nil {
		fmt.Fprintln(os.Stderr, err)
		os.Exit(1)
	}
	t := tabby.New()
	t.AddLine("ID: ", vulnerability.ID)
	t.AddLine("Name: ", vulnerability.Name)
	t.AddLine("Description: ", vulnerability.Description)
	t.AddLine("Intro: ", vulnerability.Intro)
	t.AddLine("Compliant: ", vulnerability.Compliant)
	t.AddLine("NonCompliant: ", vulnerability.NonCompliant)
	t.Print()
}
